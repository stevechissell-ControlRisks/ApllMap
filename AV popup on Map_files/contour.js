!function(t){var i=this;if("object"==typeof module&&module&&"object"==typeof module.exports&&"function"==typeof require&&(i.d3=require("d3"),i._=require("lodash")),!d3)throw new Error("You need to include d3.js before Contour. Go to http://d3js.org/");if(!_||!_.merge)throw new Error("You need to include lodash.js before Contour. Go to http://lodash.com/");!function(){var i={getValue:function(t,i,n,e){return e=Array.prototype.slice.call(arguments,3),t?"function"==typeof t?t.apply(n,e):t:i},seriesNameToClass:function(t){return t||""}},n={warn:function(t){console&&console.log&&console.log(t)}},e={firstAndLast:function(t){return[t[0],t[t.length-1]]},roundToNearest:function(t,i){return Math.ceil(t/i)*i},clamp:function(t,i,n){return t>n?n:i>t?i:t},clampLeft:function(t,i){return i>t?i:t},clampRight:function(t,i){return t>i?i:t},degToRad:function(t){return t*Math.PI/180},radToDeg:function(t){return 180*t/Math.PI},linearRegression:function(t){for(var i={},n=t.length,e=0,a=0,r=0,s=0,o=0,c=0;n>c;c++)e+=t[c].x,a+=t[c].y,r+=t[c].x*t[c].y,s+=t[c].x*t[c].x,o+=t[c].y*t[c].y;return i.slope=(n*r-e*a)/(n*s-e*e),i.intercept=(a-i.slope*e)/n,i.r2=Math.pow((n*r-e*a)/Math.sqrt((n*s-e*e)*(n*o-a*a)),2),i},niceRound:function(t){return Math.ceil(t+.1*t)}},a={textBounds:function(t,i){var n=document.getElementsByTagName("body")[0],e=document.createElement("span"),a=document.createElement("span");e.className="contour-chart",a.style.position="absolute",a.style.width="auto",a.style.height="auto",a.style.visibility="hidden",a.style.lineHeight="100%",a.style.whiteSpace="nowrap",a.innerHTML=t,a.className=i.replace(/\./g," "),e.appendChild(a),n.appendChild(e);var r={width:a.clientWidth,height:a.clientHeight};return e.removeChild(a),n.removeChild(e),r}},r={dateDiff:function(t,i){var n=t.getTime()-i.getTime();return n/864e5}},s={merge:function(t,i){return"number"==typeof t&&(t=[t]),"number"==typeof i&&(i=[i]),t&&t.length?i&&i.length?[].concat(t,i).sort(function(t,i){return t-i}):t:i},normalizeSeries:function(t,i){function n(t,i){return t.x-i.x}function e(t,e){var r={name:e,data:_.map(t,function(t,n){var e=null!=t&&t.hasOwnProperty("x"),r=function(t){return null!=t?t:null};return e?_.extend(t,{x:t.x,y:r(t.y)}):{x:a?i[n]+"":n,y:r(t)}})};return a||r.data.sort(n),r}var a=!(!i||!_.isArray(i)),r=_.isArray(t)&&_.all(t,function(t){return t.hasOwnProperty("x")&&t.hasOwnProperty("y")}),s=_.isArray(t)&&_.isObject(t[0])&&t[0].hasOwnProperty("data")&&t[0].hasOwnProperty("name")&&_.all(t[0].data,function(t){return t.hasOwnProperty("x")&&t.hasOwnProperty("y")});return s?t:r?(a||t.sort(n),[{name:"series 1",data:t}]):_.isArray(t)?_.isObject(t[0])&&t[0].hasOwnProperty("data")||_.isArray(t[0])?_.map(t,function(t,i){return e(t.data?t.data:t,t.name?t.name:"series "+(i+1))}):[e(t,"series 1")]:t},uniq:function(t){for(var i={},n=[],e=t.length,a=0;e>a;a++){var r=t[a],s=r+"";i.hasOwnProperty(s)||(i[s]=!0,n.push(r))}return n},maxTickValues:function(t,i){var n=i.length,e=[];if(t>=n)return i.slice();for(var a=Math.ceil(n/t),r=0;n>r;)e.push(i[r]),r+=a;return e},isSupportedDataFormat:function(t){return _.isArray(t)&&_.isObject(t[0])&&t[0].hasOwnProperty("data")||_.isArray(t[0])}},o={extractScaleDomain:function(t,i,n){var e=_.max(t),a=_.min(t);return null==i&&null==n?[a,e]:null==i?[Math.min(a,n),n]:null==n?[i,Math.max(i,e)]:[i,n]}},c={selectDom:function(t){return d3.select(t)[0][0]},getStyle:function(i,n){if(!i)return t;var e="string"==typeof i?this.selectDom(i):i,a=e.offsetParent?e.ownerDocument.defaultView.getComputedStyle(e,null):e.style;return n?a[n]:a}},l={warning:function(t){console&&console.log&&console.log("WARNING: "+t)}};_.nw=_.extend({},_.nw,e,s,a,r,o,l,c,i,n)}(),function(){function i(t){return this.init(t),this}var n=this,e={chart:{animations:{enable:!0,duration:400},defaultWidth:400,defaultAspect:1/1.61803398875,width:t,height:t,margin:{top:0,right:0,bottom:0,left:0},padding:{top:null,right:null,bottom:null,left:null},internalPadding:{bottom:0,left:0},rotatedFrame:!1,plotWidth:t,plotHeight:t,plotTop:t,plotLeft:t},xAxis:{},yAxis:{},tooltip:{}};i["export"]=function(n,e){function a(t){if(!t||!t.length)return[];t[0].data&&_.each(t,a);var i=_.isObject(t[0])&&_.isDate(t[0].x),n=function(t,i){return t.x-i.x};return i&&t.sort(n),t}if("function"!=typeof e)throw new Error("Invalid render function for "+n+" visualization");i.prototype[n]=function(r,s){var o,c=this.options&&this.options.xAxis?this.options.xAxis.categories:t,l=_.extend({},this.options[n],s);return r=r||[],a(r),o=new i.VisualizationContainer(_.nw.normalizeSeries(r,c),l,n,e,this),this._visualizations.push(o),this}},i.expose=function(t,n){var e=function(){var t="function"==typeof n?new n:n;return _.extend(this,_.omit(t,"init")),t.init&&t.init.call(this,this.options),this};return i.prototype[t]=e,this},i.prototype=_.extend(i.prototype,{_visualizations:t,_extraOptions:t,init:function(t){return this.options=t||{},this._extraOptions=[],this._visualizations=[],this},calculateWidth:function(){var t=_.nw.getStyle(this.options.el,"width");return this.options.el?parseInt(t,10)||this.options.chart.defaultWidth:this.options.chart.defaultWidth},calculateHeight:function(){var i=_.nw.getStyle(this.options.el,"height"),n=this.options.el?parseInt(i,10):t,e=this.options.chart.width,a=this.options.chart.aspect||this.options.chart.defaultAspect;return n&&n>1?n:Math.round(e*a)},calcMetrics:function(){var t=this.options;this.adjustPadding(),this.adjustTitlePadding(),t.chart.width=t.chart.width||this.calculateWidth(),t.chart.height=t.chart.height||this.calculateHeight(),this.options=_.merge(t,{chart:{plotWidth:t.chart.width-t.chart.margin.left-t.chart.margin.right-t.chart.internalPadding.left-t.chart.padding.right,plotHeight:t.chart.height-t.chart.margin.top-t.chart.margin.bottom-t.chart.padding.top-t.chart.internalPadding.bottom,plotLeft:t.chart.margin.left+t.chart.internalPadding.left,plotTop:t.chart.margin.top+t.chart.padding.top}})},adjustPadding:function(){return this},adjustTitlePadding:function(){return this},composeOptions:function(){var t=_.merge({},e),i=function(i){_.merge(t,i)},n=function(i){_.merge(t,i.renderer.defaults)};_.each(this._extraOptions,i),_.each(this._visualizations,n),this.options=_.merge({},t,this.options)},baseRender:function(){return this.plotArea(),this},render:function(){return this.composeOptions(),this.calcMetrics(),this.baseRender(),this.renderVisualizations(),this},update:function(){return this.calcMetrics(),this},plotArea:function(){var t=this.options.chart;return this.container=d3.select(this.options.el),this.container.attr("style","-webkit-backface-visibility: hidden;"),this.svg||(this.svg=this.container.append("svg").attr("viewBox","0 0 "+t.width+" "+t.height).attr("preserveAspectRatio","xMinYMin").attr("class","contour-chart").attr("height",t.height).append("g").attr("transform","translate("+t.margin.left+","+t.margin.top+")")),this},createVisualizationLayer:function(t,i){return this.svg.append("g").attr("vis-id",i).attr("vis-type",t.type).attr("transform","translate("+this.options.chart.internalPadding.left+","+this.options.chart.padding.top+")")},renderVisualizations:function(){return _.each(this._visualizations,function(t,i){var n=i+1,e=t.layer||this.createVisualizationLayer(t,n),a=_.merge({},this.options,t.options);t.layer=e,t.parent=this,t.render(e,a,this)},this),this},setData:function(t){return _.invoke(this._visualizations,"setData",t),this},select:function(t){return this._visualizations[t]},data:function(){}}),n.Contour=i}(),function(){function i(t,i){var n=i.chart.rotatedFrame?i.chart.plotWidth:i.chart.plotHeight,e=i.chart.rotatedFrame?[0,n]:[n,0];return t.range(e)}var n=function(t,i){this.data=t,this.options=i};n.prototype={axis:function(){var t=this.options.yAxis,i=this._scale.domain(),n=t.tickValues,e=this.numTicks(i,t.min,t.max),a=t.labels.formatter||d3.format(t.labels.format);return d3.svg.axis().scale(this._scale).tickFormat(a).tickSize(t.innerTickSize,t.outerTickSize).tickPadding(t.tickPadding).ticks(e).tickValues(n)},scale:function(t){return this._scale||(this._scale=d3.scale.linear(),this.setDomain(t),i(this._scale,this.options)),this._scale},setDomain:function(t){return this._scale.domain(t),this._niceTheScale(),this._scale},update:function(t,i){this.data=i,this.setDomain(t)},numTicks:function(){return null!=this.options.yAxis.ticks?this.options.yAxis.ticks:t},_niceTheScale:function(){this.options.yAxis.nicing&&this._scale.nice()}},_.extend(_.nw,{YAxis:n})}(),function(){var i={chart:{gridlines:"none",padding:{top:6,right:5,bottom:t,left:t}},xAxis:{type:null,categories:t,innerTickSize:6,outerTickSize:0,tickPadding:6,maxTicks:t,ticks:t,tickValues:t,title:t,titlePadding:4,innerRangePadding:.1,outerRangePadding:.1,firstAndLast:!1,orient:"bottom",labels:{format:t,formatter:t},linearDomain:!1},yAxis:{min:t,max:t,smartAxis:!1,innerTickSize:6,outerTickSize:6,tickPadding:4,tickValues:t,ticks:t,title:t,titlePadding:4,nicing:!0,orient:"left",labels:{verticalAlign:"middle",format:"s",formatter:t}}},n=function(){return{dataSrc:[],init:function(n){var e={chart:{rotatedFrame:!1,internalPadding:{bottom:t,left:t}}};this.options=n||{},_.merge(this.options,e);var a={};return this.options.xAxis&&this.options.xAxis.firstAndLast||(a={chart:{padding:{right:15}}}),this._extraOptions.push(_.merge({},i,a)),this},xDomain:[],yDomain:[],_getYScaledDomain:function(){var i=this.yDomain&&this.yDomain[0]>0?0:t;return _.nw.extractScaleDomain(this.yDomain,this.options.yAxis.min||i,this.options.yAxis.max)},adjustPadding:function(){var t=this.options.xAxis,i=this.options.yAxis,n=function(t){return Math.max(t.outerTickSize||0,t.innerTickSize||0)};if(null==this.options.chart.padding.bottom)if(0!==t.ticks){var e=this.xDomain,a=e.join("<br>"),r=_.nw.textBounds(a,".x.axis"),s=_.nw.textBounds("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890",".x.axis"),o=s.height,c=t.labels&&t.labels.rotation?t.labels.rotation%360:0,l=0===c?s.height:Math.ceil(Math.abs(r.width*Math.sin(_.nw.degToRad(c)))+o/5);this.options.chart.internalPadding.bottom=this.options.chart.padding.bottom||n(this.options.xAxis)+(this.options.xAxis.tickPadding||0)+l}else this.options.chart.internalPadding.bottom=n(this.options.xAxis)+(this.options.xAxis.tickPadding||0);else this.options.chart.internalPadding.bottom=this.options.chart.padding.bottom||0;if(null==this.options.chart.padding.left){var h=this._getYScaledDomain(),u=d3.scale.linear().domain(h),d=u.ticks(i.ticks),p=i.labels.formatter||d3.format(i.labels.format||",.0f"),x=_.map(d,p).join("<br>"),f=_.nw.textBounds(x,".y.axis");this.options.chart.internalPadding.left=this.options.chart.padding.left||n(this.options.yAxis)+(this.options.yAxis.tickPadding||0)+f.width}else this.options.chart.internalPadding.left=this.options.chart.padding.left},adjustTitlePadding:function(){var t;(this.options.xAxis.title||this.options.yAxis.title)&&(this.options.xAxis.title&&(t=_.nw.textBounds(this.options.xAxis.title,".x.axis-title"),this.options.chart.internalPadding.bottom+=t.height+this.options.xAxis.titlePadding),this.options.yAxis.title&&(t=_.nw.textBounds(this.options.yAxis.title,".y.axis-title"),this.options.chart.internalPadding.left+=t.height+this.options.yAxis.titlePadding))},computeXScale:function(){if(!this.xDomain)throw new Error("You are trying to render without setting data (xDomain).");this.xScale?(this.xScaleGenerator.update(this.xDomain,this.dataSrc),this.rangeBand=this.xScaleGenerator.rangeBand()):(this.xScaleGenerator=_.nw.xScaleFactory(this.dataSrc,this.options),this.xScale=this.xScaleGenerator.scale(this.xDomain),this.rangeBand=this.xScaleGenerator.rangeBand())},computeYScale:function(){if(!this.yDomain)throw new Error("You are trying to render without setting data (yDomain).");var t=this._getYScaledDomain();this.yScale?this.yScaleGenerator.update(t,this.dataSrc):(this.yScaleGenerator=_.nw.yScaleFactory(this.dataSrc,this.options,this.yMin,this.yMax),this.yScale=this.yScaleGenerator.scale(t))},xScale:t,yScale:t,setYDomain:function(t){this.yScaleGenerator.setDomain(t)},redrawYAxis:function(){this.svg.select(".y.axis").call(this.yAxis()),this.renderGridlines()},_animationDuration:function(){var t=this.options.chart.animations;return t&&t.enable?null!=t.duration?t.duration:400:0},computeScales:function(){return this.computeXScale(),this.computeYScale(),this},_xAxis:t,xAxis:function(){return this._xAxis||(this._xAxis=this.xScaleGenerator.axis().orient(this.options.xAxis.orient)),this._xAxis},_yAxis:t,yAxis:function(){return this._yAxis||(this._yAxis=this.yScaleGenerator.axis().orient(this.options.yAxis.orient)),this._yAxis},renderXAxis:function(){var t=this.xAxis(),i=this.options.chart.plotHeight+this.options.chart.padding.top;return this._xAxisGroup=this.svg.selectAll(".x.axis").data([1]),this._xAxisGroup.enter().append("g").attr("transform","translate("+this.options.chart.internalPadding.left+","+i+")").attr("class","x axis"),this._xAxisGroup.transition().duration(this._animationDuration()).call(t),this.xScaleGenerator.postProcessAxis(this._xAxisGroup),this},renderYAxis:function(){var t=this.options.yAxis,i={bottom:".8em",middle:".35em",top:"0"},n=this.options.chart.internalPadding.left,e=this.options.chart.padding.top;return this._yAxisGroup=this.svg.selectAll(".y.axis").data([1]),this._yAxisGroup.enter().append("g").attr("transform","translate("+n+","+e+")").attr("class","y axis"),this._yAxisGroup.transition().duration(this._animationDuration()).call(this.yAxis()).selectAll(".tick text").attr("dy",i[t.labels.verticalAlign]),this},renderAxisLabels:function(){.25*this.titleOneEm;var t,i,n,e=40/46.609;return this.options.xAxis.title&&(t=_.nw.textBounds(this.options.xAxis.title,".x.axis-title"),n=this.options.chart.internalPadding.bottom,i=0,el=this._xAxisGroup.selectAll(".x.axis-title").data([1]),el.enter().append("text").attr("class","x axis-title").attr("x",i).attr("y",n).attr("dx",(this.options.chart.plotWidth-t.width)/2).attr("dy",-2).text(this.options.xAxis.title)),this.options.yAxis.title&&(t=_.nw.textBounds(this.options.yAxis.title,".y.axis-title"),n=-this.options.chart.internalPadding.left+t.height*e,i=0,el=this._yAxisGroup.selectAll(".y.axis-title").data([1]),el.enter().append("text").attr("class","y axis-title").attr("transform","rotate(-90)").attr("x",i).attr("y",n).attr("dx",-(this.options.chart.plotHeight+t.width)/2).attr("dy",0).text(this.options.yAxis.title)),this},renderGridlines:function(){function t(t,i){var n=t.tickValues();if(!n){var e=t.ticks()[0];return t.scale().ticks(e).slice(1)}return i&&n.pop(),n.slice(1)}function i(t){return t.tickValues()||(t.scale().ticks?t.scale().ticks().slice(1):t.scale().domain())}var n,e,a=this.options.chart.gridlines,r="horizontal"===a||"both"===a,s="vertical"===a||"both"===a,o=this.xScale,c=this.yScale;if(r){n=t(this.yAxis(),this.options.yAxis.smartAxis);var l=this.options.chart.plotWidth;e=this._yAxisGroup.selectAll(".grid-lines").data([n]),e.enter().append("svg:g").attr("class","grid-lines");var h=e.selectAll(".grid-line").data(function(t){return t});h.transition().duration(this._animationDuration()).attr("x1",0).attr("x2",function(){return l}).attr("y1",c).attr("y2",c),h.enter().append("line").attr("class","grid-line").attr("x1",0).attr("x2",function(){return l}).attr("y1",c).attr("y2",c),h.exit().remove()}if(s){this._xAxisGroup.select("g.grid-lines").remove(),e=this._xAxisGroup.append("svg:g").attr("class","grid-lines"),n=i(this.xAxis());var u=this.rangeBand/2,d=this.options.chart.plotHeight;e.selectAll(".grid-line").data(n).enter().append("line").attr("class","grid-line").attr("x1",function(t){return o(t)+u}).attr("x2",function(t){return o(t)+u}).attr("y1",-d).attr("y2",0)}return this},render:function(){return this.composeOptions(),this.adjustDomain(),this.calcMetrics(),this.computeScales(),this.baseRender(),this.renderXAxis().renderYAxis().renderGridlines().renderAxisLabels().renderVisualizations(),this},datum:function(t,i){return _.isObject(t)&&_.isArray(t.data)?_.map(t.data,_.bind(this.datum,this)):{y:_.isObject(t)?t.y:t,x:_.isObject(t)?t.x:this.options.xAxis.categories?this.options.xAxis.categories[i]:i}},adjustDomain:function(){var t=this.getExtents();this.yDomain=t.length?t:[0,10],this.xDomain=this.getXDomain(),this.yMin=this.yDomain[0],this.yMax=this.yDomain[this.yDomain.length-1];var i=_.filter(this._visualizations,function(t){return _.nw.isSupportedDataFormat(t.data)});this.dataSrc=_.flatten(_.map(i,function(t){return _.flatten(_.map(t.data,_.bind(this.datum,this)))},this)),this._yAxis=null,this._xAxis=null},getExtents:function(t){var i=t&&"x"===t?"xExtent":"yExtent",n=_.filter(this._visualizations,function(t){return _.nw.isSupportedDataFormat(t.data)}),e=_.flatten(_.pluck(n,i));return e.length?d3.extent(e):[]},getXDomain:function(){var t=_.filter(this._visualizations,function(t){return _.nw.isSupportedDataFormat(t.data)}),i=_.nw.uniq(_.flatten(_.pluck(t,"xDomain")));return i}}};Contour.expose("cartesian",n)}(),Contour.version="0.9.80",function(){var t={xScaleFactory:function(t,i){var n="time"===i.xAxis.type||(_.isArray(t)&&t.length>0&&t[0].data?t[0].data[0].x&&_.isDate(t[0].data[0].x):_.isArray(t)&&t.length>0&&t[0].x&&_.isDate(t[0].x));return n&&"ordinal"!==i.xAxis.type?new _.nw.TimeScale(t,i):i.xAxis.categories||"linear"!==i.xAxis.type?new _.nw.OrdinalScale(t,i):new _.nw.LinearScale(t,i)},yScaleFactory:function(t,i,n,e){var a={log:_.nw.LogYAxis,smart:_.nw.SmartYAxis,linear:_.nw.YAxis};if(i.yAxis.type||(i.yAxis.type="linear"),"linear"===i.yAxis.type&&i.yAxis.smartAxis&&(i.yAxis.type="smart"),!a[i.yAxis.type])throw new Error('Unknown axis type: "'+i.yAxis.type+'"');return new a[i.yAxis.type](t,i,n,e)}};_.nw=_.extend({},_.nw,t)}(),function(){function t(t,i){this.options=i,this.data=t,this.init()}t.prototype={init:function(){delete this._scale},scale:function(t){return this._domain=t?this._getAxisDomain(t):this._getAxisDomain(this.data),this._scale?this._scale.domain(this._domain):(this._scale=d3.scale.linear().domain(this._domain),null==this.options.xAxis.min&&null==this.options.xAxis.max&&this._scale.nice(),this._setRange()),this._scale},axis:function(){var t=this.options.xAxis,i=t.labels.formatter||d3.format(t.labels.format||"d"),n=d3.svg.axis().scale(this._scale).tickSize(t.innerTickSize,t.outerTickSize).tickPadding(t.tickPadding).tickFormat(function(t){return _.isDate(t)?t.getDate():i(t)});return t.firstAndLast?n.tickValues(_.nw.firstAndLast(this._domain)):t.tickValues?n.tickValues(t.tickValues):null!=t.ticks&&n.ticks(t.ticks),n},update:function(t,i){this.data=i,this.scale(t)},rangeBand:function(){return 1},postProcessAxis:function(){return this},_setRange:function(){var t=this.options.chart.rotatedFrame?this.options.chart.plotHeight:this.options.chart.plotWidth,i=this.options.chart.rotatedFrame?[t,0]:[0,t];return this._scale.range(i)},_getAxisDomain:function(t){var i=this.options.xAxis.min,n=this.options.xAxis.max,e=null!=i?this.options.xAxis.min:d3.min(t),a=null!=n?this.options.xAxis.max:d3.max(t);return null!=i&&null!=n&&i>n?d3.extent(t):[e,a]}},_.nw=_.extend({},_.nw,{LinearScale:t})}(),function(){function t(t,i){var n=i.chart.rotatedFrame?i.chart.plotWidth:i.chart.plotHeight,e=i.chart.rotatedFrame?[0,n]:[n,0];return t.range(e)}var i=function(t,i){this.data=t,this.options=i};i.prototype=_.extend({},_.nw.YAxis.prototype,{axis:function(){var t=this.options.yAxis,i=this._scale.domain(),n=Math.ceil(Math.log(i[1])/Math.log(10)),e=t.labels.formatter||d3.format(t.labels.format||",.0f"),a=d3.svg.axis().scale(this._scale).tickSize(t.innerTickSize,t.outerTickSize).tickPadding(t.tickPadding);return t.labels.formatter?a.tickFormat(t.labels.formatter):a.ticks(t.ticks||n,e),a},scale:function(i){return this._scale||(i[0]<=.1&&(i[0]=.1),this._scale=d3.scale.log(),this.setDomain(i).clamp(!0),t(this._scale,this.options)),this._scale},update:function(t,i){this.data=i,t[0]<=.1&&(t[0]=.1),this.setDomain(t).clamp(!0)}}),_.extend(_.nw,{LogYAxis:i})}(),function(){function t(t,i){this.options=i,this.data=t,this.init()}t.prototype={init:function(){this.isCategorized=!0,delete this._scale},scale:function(t){return this._scale||(this._scale=new d3.scale.ordinal,this._range()),this.setDomain(t),this._scale},axis:function(){var t=this.options.xAxis,i=t.labels.format?d3.format(t.labels.format):0,n=t.labels.formatter||(this.isCategorized?0:i)||function(t){return _.isDate(t)?t.getDate():t},e=d3.svg.axis().scale(this._scale).innerTickSize(t.innerTickSize).outerTickSize(t.outerTickSize).tickPadding(t.tickPadding).tickFormat(n);return t.firstAndLast?e.tickValues(_.nw.firstAndLast(this._domain)):t.maxTicks?e.tickValues(_.nw.maxTickValues(t.maxTicks,this._domain)):t.tickValues?e.tickValues(t.tickValues):null!=t.ticks?(e.ticks(t.ticks),0===t.ticks&&e.tickValues([])):e.tickValues(t.categories),e},postProcessAxis:function(t){var i=this.options.xAxis;if(i.labels&&null!=i.labels.rotation){var n=i.labels.rotation,e=_.nw.degToRad(n),a=n>0?1:0>n?-1:0,r=.71,s=Math.cos(e),o=Math.sin(e);i.labels.rotation>0;var c=i.labels.rotation<0?"end":i.labels.rotation>0?"start":"middle";t.selectAll(".tick text").style({"text-anchor":c}).attr("transform",function(){var t=d3.select(this).attr("x")||0,n=d3.select(this).attr("y")||0;return"rotate("+i.labels.rotation+" "+t+","+n+")"}).attr("dy",function(){return(s*r).toFixed(4)+"em"}).attr("dx",function(){return-(o*r-.31*a).toFixed(4)+"em"})}},update:function(t,i){this.data=i,this.setDomain(t)},setDomain:function(t){this._domain=t,this._scale.domain(t)},rangeBand:function(){var t=this._scale.rangeBand();return t||_.nw.warn("rangeBand is 0, you may have too many points in in the domain for the size of the chart (ie. chartWidth = "+this.options.chart.plotWidth+"px and "+this._domain.length+" X-axis points (plus paddings) means less than 1 pixel per band and there're no half pixels"),this._scale.rangeBand()},_range:function(){var t=this.options.chart.rotatedFrame?[this.options.chart.plotHeight,0]:[0,this.options.chart.plotWidth];return this.isCategorized?this._scale.rangeRoundBands(t,this.options.xAxis.innerRangePadding,this.options.xAxis.outerRangePadding):this._scale.rangePoints(t)}},_.nw=_.extend({},_.nw,{OrdinalScale:t})}(),function(){function t(t,i,n,e,a){var r=_.nw.merge(t,a);return null==i&&null==n?r:null==i?n>e?_.nw.merge([n],r):[n]:null==n?i>=a?[i]:(r[0]=i,r):_.nw.merge([i,n],a)}var i=function(t,i,n,e){this.data=t,this.options=i,this.yMax=e,this.yMin=n};i.prototype=_.extend({},_.nw.YAxis.prototype,{axis:function(){var i=this.options.yAxis,n=this._scale.domain(),e=t(n,i.min,i.max,this.yMin,this.yMax),a=this.numTicks(),r=_.nw.YAxis.prototype.axis.call(this);return r.ticks(a).tickValues(e)},numTicks:function(){return 3},setDomain:function(t){var i=d3.extent(t);this.yMin=i[0],this.yMax=i[1],this._scale.domain(t),this._niceTheScale()},_niceTheScale:function(){var t=this._scale.domain(),i=[this.options.yAxis.min||t[0],this.options.yAxis.max||_.nw.niceRound(t[1])];this._scale.domain(i)}}),_.extend(_.nw,{SmartYAxis:i})}(),function(){function t(t,i){if(!t||!i)return 0;var n=t.getTime()-i.getTime();return n/864e5}function i(t,i){this.options=i,this.data=t,this.init()}i.prototype={init:function(){delete this._scale},scale:function(t){return this._scale||(this._scale=new d3.time.scale,this.setDomain(t),this.range()),this._scale},axis:function(){var t=this.options.xAxis,i=this.getOptimalTickFormat(),n=d3.svg.axis().scale(this._scale).tickFormat(i).tickSize(t.innerTickSize,t.outerTickSize).tickPadding(t.tickPadding).tickValues(this._domain);return null!=this.options.xAxis.maxTicks&&this.options.xAxis.maxTicks<this._domain.length?n.tickValues(_.nw.maxTickValues(t.maxTicks,this._domain)):this.options.xAxis.firstAndLast&&n.tickValues(_.nw.firstAndLast(this._domain)),n},update:function(t,i){this.data=i,this.setDomain(t)},setDomain:function(t){this._domain=t;var i=this._getAxisDomain(this._domain);this._scale.domain(i)},postProcessAxis:function(t){if(this.options.xAxis.firstAndLast){var i=t.selectAll(".tick text")[0];d3.select(i[0]).style({"text-anchor":"start"}),d3.select(i[i.length-1]).style({"text-anchor":"end"})}},rangeBand:function(){return 4},getOptimalTickFormat:function(){if(this.options.xAxis.labels.formatter)return this.options.xAxis.labels.formatter;if(this.options.xAxis.labels.format)return d3.time.format(this.options.xAxis.labels.format);var i=Math.abs(t(this._domain[this._domain.length-1],this._domain[0])),n=this.options.xAxis.maxTicks||1;return n>i?d3.time.format("%H:%M"):365>i?d3.time.format("%d %b"):d3.time.format("%Y")},range:function(){var t=this._getAxisRange(this._domain);return this._scale.rangeRound(t,.1)},_getAxisDomain:function(t){return this.options.xAxis.linearDomain?t:d3.extent(t)},_getAxisRange:function(t){var i=this.options.chart.rotatedFrame?this.options.chart.plotHeight:this.options.chart.plotWidth;return this.options.xAxis.linearDomain?_.range(0,i,i/(t.length-1)).concat([i]):[0,i]}},_.nw=_.extend({},_.nw,{TimeScale:i})}(),function(){var t={chart:{rotatedFrame:!0},xAxis:{orient:"left"},yAxis:{orient:"bottom"}},i={init:function(){_.merge(this.options,t)},adjustPadding:function(){var t=this.options.xAxis.categories||_.pluck(this.dataSrc,"x"),i=t.join("<br>"),n=_.nw.textBounds(i,".x.axis"),e=_.nw.textBounds("ABC",".y.axis"),a=function(t){return Math.max(t.outerTickSize,t.innerTickSize)};this.options.chart.internalPadding.left=this.options.chart.padding.left||a(this.options.xAxis)+this.options.xAxis.tickPadding+n.width,this.options.chart.internalPadding.bottom=this.options.chart.padding.bottom||a(this.options.yAxis)+this.options.yAxis.tickPadding+e.height},adjustTitlePadding:function(){var t;(this.options.xAxis.title||this.options.yAxis.title)&&(this.options.xAxis.title&&(t=_.nw.textBounds(this.options.xAxis.title,".x.axis-title"),this.options.chart.internalPadding.left+=t.height+this.options.xAxis.titlePadding),this.options.yAxis.title&&(t=_.nw.textBounds(this.options.yAxis.title,".y.axis-title"),this.options.chart.internalPadding.bottom+=t.height+this.options.yAxis.titlePadding))},renderYAxis:function(){var t=this.yAxis(),i=this.options.chart.internalPadding.left,n=this.options.chart.padding.top+this.options.chart.plotHeight;return this._yAxisGroup=this.svg.selectAll(".y.axis").data([1]),this._yAxisGroup.enter().append("g").attr("class","y axis").attr("transform","translate("+i+","+n+")"),this._yAxisGroup.exit().remove(),this._yAxisGroup.transition().duration(this._animationDuration()).attr("transform","translate("+i+","+n+")").call(t),this},renderXAxis:function(){var t=this.options.chart.internalPadding.left,i=this.options.chart.padding.top,n=this.xAxis();return this._xAxisGroup=this.svg.selectAll(".x.axis").data([1]),this._xAxisGroup.enter().append("g").attr("class","x axis").attr("transform","translate("+t+","+i+")"),this._xAxisGroup.exit().remove(),this._xAxisGroup.transition().duration(this._animationDuration()).attr("transform","translate("+t+","+i+")").call(n),this.xScaleGenerator.postProcessAxis(this._xAxisGroup),this},renderAxisLabels:function(){var t,i,n,e,a,r,s=.25*this.titleOneEm,o=40/46.609;return this.options.xAxis.title&&(t=_.nw.textBounds(this.options.xAxis.title,".x.axis-title"),a=this.options.chart.rotatedFrame?-t.height:this.options.chart.plotWidth,r=this.options.chart.rotatedFrame?-this.options.chart.internalPadding.left:this.options.chart.internalPadding.bottom-s,n=this.options.chart.rotatedFrame?"-90":"0",this._xAxisGroup.append("text").attr("class","x axis-title").attr("x",0).attr("y",r).attr("transform",["rotate(",n,")"].join("")).attr("dy",t.height*o).attr("dx",-(this.options.chart.plotHeight+t.width)/2).text(this.options.xAxis.title)),this.options.yAxis.title&&(t=_.nw.textBounds(this.options.yAxis.title,".y.axis-title"),e=Math.max(this.options.yAxis.innerTickSize,this.options.yAxis.outerTickSize),i=this.options.chart.rotatedFrame?"end":"middle",a=this.options.chart.rotatedFrame?this.options.chart.plotWidth:0,r=this.options.chart.rotatedFrame?this.options.chart.internalPadding.bottom:-this.options.chart.internalPadding.left+this.titleOneEm-s,n=this.options.chart.rotatedFrame?"0":"-90",this._yAxisGroup.append("text").attr("class","y axis-title").attr("y",r).attr("x",a).attr("dx",-(this.options.chart.plotWidth+t.width)/2).attr("dy",-4).attr("transform",["rotate(",n,")"].join("")).text(this.options.yAxis.title)),this}};Contour.expose("horizontal",i)}(),function(){function t(t,i,n,e,a){this.type=n,this.renderer=e,this.ctx=a,this.init(t,i)}var i=function(t,i){var n=[],e=[];return _.each(t,function(t){if(t.data.length){var a=_.pluck(t.data,i);n.push(d3.max(a)),e.push(d3.min(a))}}),e.length&&n.length?[_.min(e),_.max(n)]:[]},n=function(t){for(var i=_.pluck(t,"data"),n=_.max(_.map(i,function(t){return t.length})),e=[],a=0;n>a;a++)_.each(i,function(t){e[a]=t[a]?(e[a]||0)+t[a].y:e[a]||0});return[_.min(e),_.max(e)]},e=_.partialRight(i,"x"),a=_.partialRight(i,"y");t.prototype={init:function(t,i){this.setOptions(i),this.setData(t)},render:function(t,i){return this.renderer.call(this.ctx,this.data,t,i),this.ctx},setData:function(t){return this.data=_.nw.normalizeSeries(t),this._updateDomain(),this.ctx},setOptions:function(t){var i={};return i[this.type]=t||{},this.options={},this.options=_.merge({},this.renderer.defaults||{},i),this.ctx},_updateDomain:function(){if(!this.options[this.type])throw new Error("Set the options before calling setData or _updateDomain");_.nw.isSupportedDataFormat(this.data)&&(this.xDomain=_.flatten(_.map(this.data,function(t){return _.pluck(t.data,"x")})),this.xExtent=e(this.data,"x"),this.yExtent=this.options[this.type].stacked?n(this.data):a(this.data))}},Contour.VisualizationContainer=t}(),function(){function t(t,i,n){function e(){var e=i.selectAll("g.series").data(h(t));e.enter().append("svg:g").attr("class",l).append("path").datum(function(t){return t.data}).attr("class","area").attr("d",u),e.exit().remove(),n.chart.animations&&n.chart.animations.enable?e.select(".area").datum(function(t){return t.data}).transition().duration(n.chart.animations.duration||r).attr("d",d):e.select(".area").datum(function(t){return t.data}).attr("d",d),n.tooltip.enable&&a.call(this,e)}function a(t){var i=10;t.append("g").attr("class","tooltip-trackers").selectAll("tooltip-tracker").data(function(t){return t.data}).enter().append("circle").attr("class","tooltip-tracker").attr("opacity",0).attr("r",i).attr("cx",function(t){return s(t.x)}).attr("cy",function(t){return o((n.area.stacked?t.y0:0)+t.y)})}if(!this.xScale)throw new Error("Area Chart requires .cartesian() to be included in the instance.");var r=null!=n.chart.animations.duration?n.chart.animations.duration:400,s=_.bind(function(t){return this.xScale(t)+this.rangeBand/2+.5},this),o=_.bind(function(t){return this.yScale(t)+.5},this),c=n.chart.plotHeight,l=function(t,i){return"series s-"+(i+1)+" "+t.name},h=d3.layout.stack().values(function(t){return t.data}),u=d3.svg.area().x(function(t){return s(t.x)}).y0(function(){return c}).y1(function(){return c}),d=d3.svg.area().x(function(t){return s(t.x)}).y0(function(t){return o(n.area.stacked?t.y0||n.yAxis.min||0:0)}).y1(function(t){return o((n.area.stacked?t.y0:0)+t.y)});e()}var i={xAxis:{type:"linear"},area:{stacked:!0}};t.defaults=i,Contour["export"]("area",t)}(),function(){function t(t,i,n){function e(t,i){return t.attr("y",function(t){return o(t.x)}).attr("height",l),i?t.attr("x",function(){return c(0)}).attr("width",function(){return 0}):t.attr("x",function(t){return c(t.y>=0?t.y0||0:t.y+t.y0)}).attr("width",function(t){return t.y>=0?c(t.y)-c(0):c(0)-c(t.y)})}function a(i,e){var a=t.length,r=function(){return l/a-n.bar.groupPadding+.5},s=function(t,i){return l/a*i+.5};return i.attr("y",function(t,i,n){return o(t.x)+s(t,n)}).attr("x",c(0)).attr("height",r),e?i.attr("width",function(){return.5}):i.attr("width",function(t){return t.y>=0?c(t.y)-c(0):c(0)-c(t.y)}).attr("x",function(t){return c(t.y<0?t.y:0)})}if(!n.chart.rotatedFrame)throw new Error("Bar Chart requires .horizontal() to be included in the instance");var r=null!=n.chart.animations.duration?n.chart.animations.duration:400,s=this,o=function(t){
return s.xScale(t)-.5},c=function(t){return s.yScale(t)+.5},l=this.rangeBand,h=d3.layout.stack().values(function(t){return t.data}),u=n.bar.stacked?e:a,d=_.partialRight(u,!0),p=function(t,i){return"series s-"+(i+1)},x=i.selectAll("g.series").data(h(t));x.enter().append("svg:g").attr("class",p),x.exit().remove();var f=x.selectAll(".bar").data(function(t){return t.data}),m="bar"+(n.tooltip.enable?" tooltip-tracker":"");f.enter().append("rect").attr("class",m).call(d),n.chart.animations&&n.chart.animations.enable?(f.transition().duration(r).call(u),f.exit().transition().duration(r).attr("width",c(0)).remove()):(f.call(u),f.exit().remove())}var i={bar:{stacked:!1,groupPadding:2}};t.defaults=i,Contour["export"]("bar",t)}(),function(){function t(t,i,n){function e(t,i){var n=h(0);t.attr("x",function(t){return l(t.x)+d}).attr("width",function(){return p}),i?t.attr("y",function(t){return t.y>=0?n:n}).attr("height",function(){return.5}):t.attr("y",function(t){return t.y>=0?h(t.y)+h(t.y0)-n:h(t.y0)}).attr("height",function(t){return t.y>=0?n-h(t.y):h(t.y)-n})}function a(i,n){var e=p/t.length-s.groupPadding+.5,a=function(i,n){return p/t.length*n+.5},r=h(0);i.attr("x",function(t,i,n){return l(t.x)+a(t,n)+d}).attr("width",e),n?i.attr("y",r).attr("height",0):i.attr("y",function(t){return t.y>=0?h(t.y):r}).attr("height",function(t){return t.y>=0?r-h(t.y):h(t.y)-r})}if(!this.xScale)throw new Error("Column Chart requires .cartesian() to be included in the instance.");var r=null!=n.chart.animations.duration?n.chart.animations.duration:400,s=n.column;n.chart.plotWidth;var o=n.chart.plotHeight,c=this,l=function(t){return Math.round(c.xScale(t))+.5},h=function(t){return Math.round(c.yScale(t))-.5},u=function(t){return t.data},d=_.nw.getValue(s.offset,0,this),p=_.nw.getValue(s.columnWidth,this.rangeBand,this),x=_.partialRight(n.column.stacked?e:a,!0),f=n.column.stacked?e:a,m=_.map(t,function(t){return{name:t.name,data:_.filter(t.data,function(i,n){return 0===n?!0:l(i.x)!==l(t.data[n-1].x)})}}),g=d3.layout.stack().values(function(t){return t.data}),y=i.selectAll("g.series").data(g(m));y.enter().append("g").attr("class",function(t,i){return"series s-"+(i+1)}),y.exit().remove();var A=y.selectAll(".column").data(u);p/t.length-s.groupPadding-.5;var v="column"+(n.tooltip.enable?" tooltip-tracker":"");A.enter().append("rect").attr("class",v).call(x),n.chart.animations&&n.chart.animations.enable?(A.exit().transition().duration(r).attr("y",o).attr("height",function(){return.5}).remove(),A.transition().duration(r).call(f)):(A.exit().remove(),A.call(f))}var i={column:{stacked:!1,groupPadding:1,columnWidth:function(){return this.rangeBand},offset:function(){return 0}}};t.defaults=i,Contour["export"]("column",t)}(),function(){Contour["export"]("coolNarwhal",function(t,i){i.append("path").attr("class","cool").attr("opacity",0).attr("transform","scale(.5) translate(500 150)").attr("d","M-220.02,76.509l-0.78,8.927c-0.956,10.949,1.389,20.422,6.188,30.383c10.203,21.173,63.095,84.05,93.72,115.075c20.145,20.406,19.487,23.018,21.549,40.122c2.487,20.621,24.897,66.462,40.838,71.269 c15.086,4.549,12.91-12.398,13.319-37.83c5.746,2.457,10.917,5.638,20.206,12.697c61.697,46.892,139.734,69.97,206.5,71.733c46.209,1.221,81.432-7.081,142.957-33.694c40.484-17.512,54.271-22.098,65.639-21.504c4.432,0.232,22.678,11.204,41.746,21.563c35.398,19.229,69.457,34.595,75.896,34.239c12.609-1.457-0.701-11.783-8.072-24.217c-7.049-11.892-15.414-29.572-18.844-42.134s-4.723-22.272-8.91-27.091c-2.143-2.463-12.812-6.786-21.189-8.146c-18.045-2.933-22.191-2.922-13.531-8.957c13.076-9.115,17.377-11.039,1.826-29.068c-6.383-7.402-11.336-20.003-13.709-39.542c-1.607-13.237,1.057-23.679-3.869-27.451s-17.271,12.341-20.846,19.334c-2.01,3.937-7.102,19.005-11.312,33.485c-13.795,47.427-29.865,65.742-62.693,71.447c-34.361,5.971-71.623-9.506-116.543-48.404c-13.164-11.399-29.533-25.26-39.254-36.913c-13.428-16.101-15.48-18.138-19.785-20.66c-16.166-9.472-54.98-31.694-103.525-63.815c-24.393-16.141-57.72-36.928-71.453-43.693c-27.236-13.417-68.416-28.952-90.731-46.771c-24.665-19.697-38.108-19.793-67.804-5.479c-21.429,10.328-23.941,15.298-26.52,15.726c-8.216-10.129-22.917-11.198-31.647-20.682c-9.529-10.35-28.027-14.098-37.824-24.957c-10.668-11.826-31.25-16.752-40.886-26.94c-11.339-11.989-29.387-16.096-40.838-26.637c-11.617-10.694-27.159-14.843-37.68-24.045c-10.383-9.082-23.187-12.538-31.408-19.163c-8.193-6.601-16.593-9.444-22.026-11.993c-5.433-2.549-7.398-2.522-7.658-1.927c-0.26,0.594,1.355,2.955,6.054,6.447c4.699,3.491,22.193,18.451,31.645,22.77c10.921,5.104,17.502,15.01,29.671,21.375c13.224,6.918,22.212,18.731,36.229,25.924c15.53,7.971,24.754,21.184,39.657,28.253c16.462,7.808,25.503,21.598,39.958,28.36c14.499,6.78,20.647,20.252,34.429,23.428C-238.033,58.207-227.932,70.443-220.02,76.509L-220.02,76.509z").transition().delay(300).duration(2e3).attr("opacity",1)})}(),function(){function t(t){var i=[];return-1!=["top","middle","bottom"].indexOf(t.legend.vAlign)?i.push(t.legend.vAlign):i.push("top"),-1!=["left","center","right"].indexOf(t.legend.hAlign)?i.push(t.legend.hAlign):i.push("right"),"vertical"===t.legend.direction&&i.push("vertical"),i}function i(i,n,e){var a=this.container.selectAll(".contour-legend").data([null]),r=_.nw.textBounds("series",".contour-legend.contour-legend-entry"),s=i.length,o=(r.height+4)*s+12,c=(e.chart.plotHeight-o)/2,l=function(t){if("center"===e.legend.hAlign&&t.length){var i=t[0].parentNode.clientWidth,n=(e.chart.plotWidth-i)/2+e.chart.internalPadding.left;d3.select(t[0].parentNode).style("left",n+"px")}},h=a.enter().append("div").attr("class",function(){return["contour-legend"].concat(t(e)).join(" ")}).attr("style",function(){var t=[];if("top"===e.legend.vAlign?t.push("top: 0"):"middle"===e.legend.vAlign?t.push("top: "+c+"px"):t.push("bottom: "+(e.chart.internalPadding.bottom+5)+"px"),"left"===e.legend.hAlign)t.push("left: "+e.chart.plotLeft+"px");else if("center"===e.legend.hAlign){var i=_.nw.textBounds(this,".contour-legend");t.push("left: "+((e.chart.plotWidth-i.width)/2+e.chart.internalPadding.left)+"px")}else t.push("right: 10px");return t.join(";")}),u=h.selectAll(".contour-legend-entry").data(i,function(t){return t.name});u.enter().append("div").attr("class",function(){return"contour-legend-entry"}),u.append("span").attr("class",function(t,i){return"contour-legend-key series s-"+(i+1)+" "+_.nw.seriesNameToClass(t.name)}),u.append("span").attr("class","series-name").text(e.legend.formatter).call(l),u.exit().remove()}var n={legend:{vAlign:"middle",hAlign:"right",direction:"vertical",formatter:function(t){return t.name}}};i.defaults=n,Contour["export"]("legend",i)}(),function(){function t(t,e,r){function s(t){return function(i,n){return(t||"")+" s-"+(n+1)+" "+_.nw.seriesNameToClass(i.name)}}function o(){var t=d3.svg.line().x(function(t){return h(t)}).y(function(){return u({x:0,y:r.yAxis.min||0})}),i=d3.svg.line().x(function(t){return h(t)}).y(function(t){return u(t)});r.line.smooth&&i.interpolate("cardinal");var o=a[n],c=e.selectAll("g.series").data(p,function(t){return t.name}),l=c.enter().append("svg:g").attr("class",s("series")).append("path").attr("class","line");if(d){var x="left-to-right"===n?i:t;l.attr("d",function(t){return x(t.data)}).call(_.partial(o.enter,i))}else l.attr("d",function(t){return i(t.data)});l=c.attr("class",s("series")).select(".line"),d?l.call(_.partial(o.update,i)):l.attr("d",function(t){return i(t.data)}),d?c.exit().remove():c.exit().remove()}function c(){var t=e.selectAll(".line-chart-markers").data(p,function(t){return t.name});t.enter().append("g").attr("class",s("line-chart-markers markers")),t.exit().remove();var n=t.selectAll(".dot").data(function(t){return t.data},function(t){return t.x});n.enter().append("circle").attr("class","dot").attr("r",r.line.marker.size).attr("opacity",0),n.exit().remove(),d?n.transition().delay(i).attr("cx",h).attr("cy",u).attr("opacity",1):n.attr("cx",h).attr("cy",u).attr("opacity",1)}function l(){var t=10,i=e.selectAll(".tooltip-trackers").data(p,function(t){return t.name});i.enter().append("g").attr("class",function(t,i){return"tooltip-trackers s-"+(i+1)}),i.exit().remove();var n=i.selectAll(".tooltip-tracker").data(function(t){return t.data},function(t){return t.x});n.enter().append("circle").attr({"class":"tooltip-tracker",r:t,opacity:0}),n.attr({cx:h,cy:u}),n.exit().remove()}if(!this.xScale)throw new Error("Line Chart requires .cartesian() to be included in the instance.");var h=_.bind(function(t){return this.xScale(t.x)+this.rangeBand/2+.5},this),u=_.bind(function(t){return this.yScale(t.y)+.5},this);r.chart.plotHeight;var d=r.chart.animations&&r.chart.animations.enable;n=r.line.animationDirection||"left-to-right",i=null!=r.chart.animations.duration?r.chart.animations.duration:400;var p=_.map(t,function(t){return _.extend(t,{data:_.filter(t.data,function(i,n){if(0===n&&null!=i.y)return!0;var e=h(t.data[n-1])!==h(i);return null!=i.y&&e})})});return o(),r.line.marker.enable&&c(),r.tooltip&&r.tooltip.enable&&l(),this}var i,n,e={line:{smooth:!1,animationDirection:"left-to-right",marker:{enable:!0,size:3}}},a={"left-to-right":{enter:function(){var t=this;t.each(function(){var t=this.getTotalLength();d3.select(this).attr("stroke-dasharray",t+" "+t).attr("stroke-dashoffset",t).transition().duration(i).ease("linear").attr("stroke-dashoffset",0)})},update:function(t){this.attr("d",function(i){return t(i.data)}),this.each(function(){var t=this.getTotalLength();d3.select(this).attr("stroke-dasharray",t+" "+t).attr("stroke-dashoffset",t).transition().duration(i).ease("linear").attr("stroke-dashoffset",0)})}},"bottom-to-top":{enter:function(t){this.transition().duration(i).attr("d",function(i){return t(i.data)})},update:function(t){this.transition().duration(i).attr("d",function(i){return t(i.data)})}}};t.defaults=e,Contour["export"]("line",t)}(),Contour["export"]("nullVis",_.noop),function(){function t(t,i,n){function e(t){function i(t){var i=d3.interpolate(this._current,t);return this._current=i(0),function(t){return n(i(t))}}var n=d3.svg.arc().outerRadius(u).innerRadius(d),e=d3.svg.arc().outerRadius(u).innerRadius(d).startAngle(0).endAngle(0),s=t.selectAll("path").data(function(t){return x(t.data)},function(t){return t.data.x});s.enter().append("path").attr("class",p).attr("d",function(t){return e(t)}).each(function(t){this._current={startAngle:t.startAngle,endAngle:t.startAngle}}),r?(s.exit().remove(),s.transition().duration(a).ease("cubic-in").attrTween("d",i)):(s.exit().remove(),s.attr("d",n))}var a=null!=n.chart.animations.duration?n.chart.animations.duration:400,r=n.chart.animations&&n.chart.animations.enable,s=n.chart.plotWidth,o=n.chart.plotHeight,c=_.nw.clamp(_.nw.getValue(n.pie.piePadding,0,this),0,o/2-2),l=t.length,h=Math.min(s/l,o)/2-c,u=_.nw.getValue(n.pie.outerRadius,h,this,h),d=_.nw.getValue(n.pie.innerRadius,0,this,u),p=function(t,i){return"series arc"+(n.tooltip.enable?" tooltip-tracker":"")+" s-"+(i+1)+" "+t.name},x=d3.layout.pie().value(function(t){return t.y}).sort(null),f=function(t,i){var n=2*u+c;return"translate("+(u+c+n*i)+","+(u+c)+")"},m=i.selectAll("g.pie-group").data(t);m.enter().append("svg:g").attr("class","pie-group").attr("transform",f).call(e),m.exit().remove(),r?m.call(e).transition().duration(a/2).attr("transform",f):m.call(e).attr("transform",f)}var i={pie:{piePadding:1,innerRadius:null,outerRadius:null}};t.defaults=i,Contour["export"]("pie",t)}(),function(){function t(t,i,n){if(!this.xScale)throw new Error("Scatter Chart requires .cartesian() to be included in the instance.");var e=null!=n.chart.animations.duration?n.chart.animations.duration:400,a=n.chart.animations&&n.chart.animations.enable,r=n.scatter,s=this.rangeBand/2,e=400,o=_.bind(function(t){return this.xScale(t.x)+s},this),c=_.bind(function(t){return this.yScale(t.y)},this),l=n.chart.plotHeight,h=function(t,i){return t.name+" series s-"+(i+1)},u=i.selectAll(".series").data(t);u.attr("class",h),u.enter().append("svg:g").attr("class",h),u.exit().remove();var d=u.selectAll(".dot").data(function(t){return t.data},function(t){return n.scatter.dataKey?t[n.scatter.dataKey]:t.x});d.enter().append("circle").attr("class","dot tooltip-tracker").attr("r",r.radius).attr("cx",o).attr("cy",l),a?d.transition().duration(e).attr("r",r.radius).attr("cx",o).attr("cy",c):d.attr("r",r.radius).attr("cx",o).attr("cy",c),d.exit().remove()}var i={xAxis:{type:"linear"},scatter:{radius:4}};t.defaults=i,Contour["export"]("scatter",t)}(),function(){Contour["export"]("stackTooltip",function(t,i,n){var e=this.yAxis().tickFormat(),a=d3.select(n.stackTooltip.el);a.classed("stack-tooltip",!0);var r=function(i){var r=function(t){return!(t&&null!=t.y)},s=function(t,e){var a=_.isNumber(i.x)?i.x:n.xAxis.categories.indexOf(i.x);return r(t.data[a])?null:{seriesName:t.name,value:t.data[a].y,cssClass:"s-"+(e+1)}},o=_.filter(_.map(t,s),function(t){return t}),c=_.map(o,function(t){return'<span class="'+t.cssClass+'"">'+t.seriesName+": "+e(t.value)+"</span>"}).join(" / ");a.html(c).style({display:"block"})},s=function(){a.html("")};this.svg.selectAll(".tooltip-tracker").on("mouseover",r.bind(this)).on("mouseout",s.bind(this))})}(),function(){function t(t,i,n){var e=function(){clearTimeout(this.tooltip.hideTimer)},a=function(t,i){this.options.tooltip.animate?this.tooltipElement.transition().duration(i).style("opacity",t):this.tooltipElement.style("opacity",t)},r=function(t){var i=t.getBoundingClientRect();return t.getBoundingClientRect(),[i.left+i.width/2,i.top+i.height/2]},s=function(t){var i,e=function(){return"path"===d3.event.target.tagName?r(d3.event.target):d3.mouse(this.container.node())},a=this.xScale,s=this.yScale,o=this.options.chart.plotLeft,c=this.options.chart.plotWidth,l=this.options.chart.plotTop,h=this.options.chart.plotHeight,u=this.options.tooltip.distance,d=parseFloat(this.tooltipElement.style("width")),p=parseFloat(this.tooltipElement.style("height")),x=a?a(t.x):e()[0],f=s?s(t.y):e()[1],m=function(t){return t.x<o&&(t.x=o+u),t.x+d>o+c&&(t.x-=t.x+d-(o+c),t.y=l+f-(p+u),i=!0),t.y<l&&(t.y=l+u,i&&f>=t.y&&f<=t.y+p&&(t.y=f+l+u)),t.y+p>l+h&&(t.y=Math.max(l,l+h-(p+u))),t},g={vertical:function(){var t={x:o+x-(u+d),y:l+f-(u+p)};return m(t)},horizontal:function(){var t={x:o+f-(u+d),y:l+x-(u+p)};return m(t)}};return n.chart.rotatedFrame?g.horizontal():g.vertical()},o=function(t){h.call(this,t)},c=function(){a.call(this,0,this.options.tooltip.hideTime)},l=function(t){function i(){var t=Array.prototype.slice.call(arguments),i=t[0],n=t.slice(1),e=_.map(i,function(t){return t.apply(this,n)}).concat([_.noop]);return _.first(_.select(e))}var n=this.options.tooltip,e=[function(t){return n.formatter?_.partial(n.formatter,t):null},function(t){return t.hasOwnProperty("x")?_.partial(function(t){return t.x+"<br>"+t.y},t):null},function(t){return t.data&&t.data.hasOwnProperty("x")?_.partial(function(t){return t.x+"<br>"+t.y},t.data):null},function(t){return t.hasOwnProperty("value")?_.partial(function(t){return t.value},t):null},function(){return function(){return"NA"}}];return i(e,t)()},h=function(t){e.call(this),this.tooltipElement.select(".text").html(l.call(this,t));var i=s.call(this,t);this.tooltipElement.style("top",i.y+"px").style("left",i.x+"px"),a.call(this,this.options.tooltip.opacity,this.options.tooltip.showTime)};this.tooltipElement=this.container.style("position","relative").selectAll(".nw-tooltip").data([1]),this.tooltipElement.enter().append("div").attr("class","nw-tooltip").style("opacity",0).append("div").attr("class","text"),this.svg.selectAll(".tooltip-tracker").on("mouseover.tooltip",o.bind(this)).on("mouseout.tooltip",c.bind(this))}var i={tooltip:{enable:!0,animate:!0,opacity:.85,showTime:300,hideTime:500,distance:5}};t.defaults=i,Contour["export"]("tooltip",t)}(),function(){function t(t,i,n){if(!this.xScale)throw new Error("Trend Line requires .cartesian() to be included in the instance.");var e=null!=n.chart.animations.duration?n.chart.animations.duration:400,a=n.chart.animations&&n.chart.animations.enable,r=_.bind(function(t){return this.xScale(t)+this.rangeBand/2},this),s=_.bind(function(t){return this.yScale(t)},this),o=_.nw.linearRegression(_.flatten(_.pluck(t,"data"))),c=d3.extent(this.xScale.domain()),l=function(t){return o.intercept+o.slope*t},h=i.selectAll(".trend-line").data([1]);h.enter().append("line").attr("class","trend-line").attr("x1",r(c[0])).attr("y1",s(l(c[0]))).attr("x2",r(c[0])).attr("y2",s(l(c[0]))),h.exit().remove(),a?h.transition().duration(e).attr("x1",r(c[0])).attr("y1",s(l(c[0]))).attr("x2",r(c[1])).attr("y2",s(l(c[1]))):h.attr("x1",r(c[0])).attr("y1",s(l(c[0]))).attr("x2",r(c[1])).attr("y2",s(l(c[1])))}t.defaults={},Contour["export"]("trendLine",t)}(),"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=Contour:(i.Contour=Contour,"function"==typeof define&&define.amd&&define("contour",[],function(){return Contour}))}();